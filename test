private void writeSchemaToSpos(Schema schema, String schemaFileKey) {
    // Convert the schema to a string
    String schemaContent = schema.toString(true); // Pretty-print the schema

    // Convert the string to bytes
    byte[] schemaBytes = schemaContent.getBytes(StandardCharsets.UTF_8);

    // Create a RequestBody from the byte array
    RequestBody requestBody = RequestBody.fromBytes(schemaBytes);

    // Build the PutObjectRequest
    PutObjectRequest putObjectRequest = PutObjectRequest.builder()
            .bucket(sposConfig.bucket())
            .key(schemaFileKey)
            .build();

    // Upload the schema file to SPOS
    try {
        s3Client.putObject(putObjectRequest, requestBody);
        System.out.println("Schema uploaded successfully to SPOS: " + schemaFileKey);
    } catch (S3Exception e) {
        e.printStackTrace();
        throw new RuntimeException("Error uploading schema to SPOS", e);
    }
}
